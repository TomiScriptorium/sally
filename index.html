<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sally ‚Äî Buscador de preguntas tontas</title>
  <meta name="description" content="Sally: pregunta lo que sea, incluso lo m√°s tonto. Minimalista, sin historial, con una oveja mascota." />
  <style>
    :root{--bg:#ffffff;--fg:#0b0b0b;--muted:#6b6b6b;--accent:#e63946;--card:#f7f7f7}
    [data-theme='dark']{--bg:#0b0b0b;--fg:#f2f2f2;--muted:#bdbdbd;--accent:#ff6b6b;--card:#111111}
    *{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--fg)}
    .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:32px}
    .card{width:100%;max-width:960px;background:transparent}
    header{display:flex;align-items:center;gap:16px;margin-bottom:22px}
    h1{margin:0;font-size:28px;letter-spacing:0.2px}
    .sub{color:var(--muted);font-size:14px}

    .app{display:grid;grid-template-columns:260px 1fr;gap:20px}
    .left{display:flex;flex-direction:column;gap:12px}
    .panel{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 6px 20px rgba(0,0,0,0.04)}

    /* Mascota area */
    .mascota{position:relative;height:240px;display:flex;align-items:center;justify-content:center}
    .sheep{width:180px;height:180px;position:relative;transform-origin:center;animation:bounce 2.6s ease-in-out infinite}
    .sheep img{width:100%;height:100%;object-fit:contain;display:block}
    @keyframes bounce{0%{transform:translateY(0)}50%{transform:translateY(-6px)}100%{transform:translateY(0)}}

    /* Input area */
    .searchArea{display:flex;align-items:center;gap:12px}
    .inputWrap{flex:1;position:relative}
    input.search{width:100%;padding:14px 16px;border-radius:12px;border:1px solid rgba(0,0,0,0.08);font-size:16px;background:transparent;color:var(--fg)}
    [data-theme='dark'] input.search{border-color:rgba(255,255,255,0.06)}

    /* patita (pointer) */
    .patita{position:absolute;right:10px;top:50%;transform:translateY(-50%);width:56px;height:56px;pointer-events:none;opacity:0.95}
    .patita img{width:100%;height:100%;object-fit:contain}

    button.primary{background:var(--accent);color:white;border:none;padding:12px 16px;border-radius:10px;font-weight:600;cursor:pointer}
    .info{color:var(--muted);font-size:13px}

    /* results */
    .results{background:var(--card);padding:14px;border-radius:12px;min-height:160px}
    .resultItem{padding:12px;border-radius:8px;background:transparent;margin-bottom:8px}
    .resultText{font-size:15px}

    /* achievements */
    .ach{display:flex;flex-direction:column;gap:8px}
    .achItem{display:flex;align-items:center;gap:10px;padding:8px;border-radius:8px;background:linear-gradient(90deg,transparent,rgba(0,0,0,0.02));font-size:13px}

    footer{margin-top:14px;color:var(--muted);font-size:13px}

    /* responsive */
    @media (max-width:820px){.app{grid-template-columns:1fr;}.mascota{height:180px}.sheep{width:140px;height:140px}}
  </style>
</head>
<body data-theme="light">
  <div class="wrap">
    <div class="card">
      <header>
        <div style="display:flex;flex-direction:column">
          <h1>Sally</h1>
          <div class="sub">El buscador exclusivo para preguntas tontas ‚Äî pregunta lo que quieras.</div>
        </div>
        <div style="margin-left:auto;display:flex;gap:10px;align-items:center">
          <div class="info">Powered by <strong>Gemini</strong></div>
          <label style="display:flex;align-items:center;gap:8px">
            <input id="themeToggle" type="checkbox" /> Modo oscuro
          </label>
        </div>
      </header>

      <div class="app">
        <div class="left">
          <div class="panel mascota">
            <!-- Oveja animada: usa las im√°genes disponibles. Cambia seg√∫n nivel. -->
            <div class="sheep" id="sheep">
              <img id="sheepImg" src="/mnt/data/Gemini_Generated_Image_3jhf333jhf333jhf.png" alt="oveja" />
            </div>
            <!-- Patita que se√±ala el cuadro de texto -->
            <div class="patita" id="patita">
              <img src="/mnt/data/Gemini_Generated_Image_5hn0365hn0365hn0.png" alt="patita" />
            </div>
            <div style="position:absolute;left:14px;bottom:10px;font-size:13px;color:var(--muted)">Hola, soy Sally üêë</div>
          </div>

          <div class="panel">
            <div style="font-weight:600;margin-bottom:8px">Nivel</div>
            <div id="levelBox">Nivel 1 ‚Äî 0 XP</div>
          </div>

          <div class="panel ach">
            <div style="font-weight:600">Logros</div>
            <div id="achList">
              <div class="achItem">(Vacio) ‚Äî Haz una pregunta para empezar</div>
            </div>
          </div>
        </div>

        <div>
          <div class="panel">
            <div style="display:flex;align-items:center;justify-content:space-between">
              <div style="font-weight:600">Pregunta lo que sea</div>
              <div class="info">No guardamos historial. Todo en memoria (temporal).</div>
            </div>

            <div style="margin-top:12px" class="searchArea">
              <div class="inputWrap">
                <input id="query" class="search" placeholder="Escribe tu pregunta tonta aqu√≠... (ej: ¬øpor qu√© el cielo es azul?)" autocomplete="off" />
                <div class="patita" style="right:8px;top:calc(50% + 2px)" id="inputPatita"><img src="/mnt/data/Gemini_Generated_Image_f8y2wdf8y2wdf8y2.png" alt="patita" /></div>
              </div>
              <button id="askBtn" class="primary">Preguntar</button>
            </div>

            <div style="margin-top:12px" class="results" id="results">
              <div class="info">Tus respuestas aparecer√°n aqu√≠. Sally est√° 'powered by Gemini' ‚Äî si quieres conectar con Gemini real, configura tu servidor que haga la llamada a la API y devuelve el texto a esta app (esto evita exponer claves en el navegador).</div>
            </div>

            <footer>
              Sally no guarda ning√∫n dato. Cierra o recarga la p√°gina para reiniciar a 0.
            </footer>
          </div>

          <div style="height:12px"></div>

          <div class="panel" style="display:flex;gap:12px;align-items:center;justify-content:space-between">
            <div>
              <div style="font-weight:600">Preferencias</div>
              <div class="info">Modo claro/oscuro ‚Äî sin sincronizaci√≥n ni almacenamiento.</div>
            </div>
            <div style="display:flex;gap:8px">
              <button id="resetBtn">Reiniciar nivel</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Sally single-file app
    // Nota: por privacidad y por pedido del usuario, NO se guarda ninguna informaci√≥n en almacenamiento persistente.

    const themeToggle = document.getElementById('themeToggle')
    const body = document.body
    themeToggle.addEventListener('change', ()=>{
      body.setAttribute('data-theme', themeToggle.checked ? 'dark' : 'light')
      checkAchievement('modo_oscuro', themeToggle.checked)
    })

    // Estado en memoria (reseteable con recarga)
    const state = {
      xp: 0,
      level: 1,
      questionsAsked: 0,
      achievements: new Set()
    }

    const xpForNext = (lvl)=> Math.floor(5 + lvl*5) // sencilla curva

    function updateLevelUI(){
      document.getElementById('levelBox').textContent = `Nivel ${state.level} ‚Äî ${state.xp} XP (siguiente: ${xpForNext(state.level)} XP)`
      // cambiar imagen de la oveja seg√∫n nivel (usa distintas im√°genes disponibles)
      const sheepImg = document.getElementById('sheepImg')
      if(state.level >= 6) sheepImg.src = '/mnt/data/Gemini_Generated_Image_yshtwdyshtwdysht.png'
      else if(state.level >= 3) sheepImg.src = '/mnt/data/Gemini_Generated_Image_6jk9y46jk9y46jk9.png'
      else sheepImg.src = '/mnt/data/Gemini_Generated_Image_3jhf333jhf333jhf.png'
    }

    function addXP(amount){
      state.xp += amount
      while(state.xp >= xpForNext(state.level)){
        state.xp -= xpForNext(state.level)
        state.level += 1
        celebrateLevelUp()
      }
      updateLevelUI()
    }

    function celebrateLevelUp(){
      // peque√±a animaci√≥n -> temporiza cambio de imagen y efecto
      const sheep = document.getElementById('sheep')
      sheep.style.transform = 'scale(1.08)'
      setTimeout(()=> sheep.style.transform = '' , 700)
      checkAchievement('subir_nivel')
    }

    // Achievements simples y relativamente f√°ciles de completar
    const ACH_DEFS = [
      {id:'primera_pregunta',txt:'Hiciste tu primera pregunta'},
      {id:'preguntas_5',txt:'Hiciste 5 preguntas'},
      {id:'modo_oscuro',txt:'Probaste el modo oscuro'},
      {id:'subir_nivel',txt:'Subiste de nivel'},
      {id:'pregunta_larga',txt:'Hiciste una pregunta larga (m√°s de 60 caracteres)'}
    ]

    function checkAchievement(id,condition=true){
      if(state.achievements.has(id)) return
      if(!condition) return
      state.achievements.add(id)
      renderAchievements()
    }

    function renderAchievements(){
      const container = document.getElementById('achList')
      container.innerHTML = ''
      if(state.achievements.size === 0){
        container.innerHTML = '<div class="achItem">(Vacio) ‚Äî Haz una pregunta para empezar</div>'
        return
      }
      for(const a of ACH_DEFS){
        const unlocked = state.achievements.has(a.id)
        const div = document.createElement('div')
        div.className = 'achItem'
        div.textContent = (unlocked ? 'üèÜ ' : 'üîí ') + a.txt
        container.appendChild(div)
      }
    }

    // UI: resultados
    const results = document.getElementById('results')
    function showResult(text,meta=''){
      const el = document.createElement('div')
      el.className = 'resultItem'
      el.innerHTML = `<div class='resultText'>${escapeHtml(text)}</div><div class='info' style='margin-top:6px'>${escapeHtml(meta)}</div>`
      results.prepend(el)
    }

    function escapeHtml(s){return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')}

    // Patita que se√±ala el cuadro de texto: animaci√≥n cuando el input est√° enfocado
    const input = document.getElementById('query')
    const inputPatita = document.getElementById('inputPatita')
    input.addEventListener('focus', ()=>{
      inputPatita.style.transform = 'translateX(-6px)'
      inputPatita.style.transition = 'transform .18s ease-out'
    })
    input.addEventListener('blur', ()=>{
      inputPatita.style.transform = ''
    })

    // Preguntar (simulaci√≥n). Si el usuario tiene un servidor que conecte con Gemini, puede usar la funci√≥n fetchGemini.
    document.getElementById('askBtn').addEventListener('click', ask)
    input.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') ask() })

    function ask(){
      const q = input.value.trim()
      if(!q) return

      // estado
      state.questionsAsked += 1
      if(state.questionsAsked === 1) checkAchievement('primera_pregunta')
      if(state.questionsAsked >= 5) checkAchievement('preguntas_5')
      if(q.length > 60) checkAchievement('pregunta_larga')

      // XP muy simple: 1 XP por pregunta + 1 XP por cada 30 chars
      const xpGain = 1 + Math.floor(q.length / 30)
      addXP(xpGain)

      // Mostrar una respuesta 'simulada' y amigable. Si quieres conectar Gemini real, implementa fetchGemini(q)
      showResult(`Sally responde: "${mockAnswer(q)}"`, `+${xpGain} XP ‚Äî pregunta #${state.questionsAsked}`)

      // limpiar input ‚Äî no se guarda historicamente
      input.value = ''
      input.blur()
    }

    function mockAnswer(q){
      // Respuestas juguetonas; garantiza que la app funciona sin backend.
      const samples = [
        'Buena pregunta. Nadie lo sabe con seguridad, pero suena divertido.',
        'Probablemente s√≠. O tal vez no. ¬°Investiguemos con una taza de t√©!',
        'Eso depende del color de tus calcetines.',
        'La respuesta corta es: preg√∫ntale a una oveja.',
        'No es tonto preguntar eso ‚Äî es genial. Mi respuesta: 42.'
      ]
      // si pregunta por ortograf√≠a o traducci√≥n, dar ejemplo simple
      if(/como se escribe|c√≥mo se escribe|how to spell|spell/i.test(q)){
        const w = q.split(' ').slice(-1)[0].replace(/[?¬ø]/g,'')
        return `La forma m√°s probable es: "${w}"`;
      }
      if(/como se dice|c√≥mo se dice|translate|traduce/i.test(q)){
        return 'D√≠melo en tu idioma preferido y yo te doy una versi√≥n corta.'
      }
      return samples[Math.floor(Math.random()*samples.length)]
    }

    // -- Integraci√≥n con Gemini (comentada) --
    // Para evitar exponer claves en el navegador, la recomendaci√≥n es: crear un endpoint en tu servidor
    // que reciba la consulta y haga la llamada a la API de Gemini con tu clave. Luego devuelve el texto a esta app.
    // Ejemplo (pseudo):
    // async function fetchGemini(prompt){
    //   const resp = await fetch('/api/gemini', {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({prompt})})
    //   const j = await resp.json(); return j.text
    // }

    // Reiniciar nivel (solo en memoria)
    document.getElementById('resetBtn').addEventListener('click', ()=>{
      state.xp = 0; state.level = 1; state.questionsAsked = 0; state.achievements = new Set(); updateLevelUI(); renderAchievements(); results.innerHTML = '<div class="info">Tus respuestas aparecer√°n aqu√≠. Sally no guarda historial.</div>'
    })

    // inicializar UI
    updateLevelUI(); renderAchievements();

    // Peque√±o easter: si el usuario hace clic en la mascota varias veces, cambia a otra expresi√≥n
    const sheep = document.getElementById('sheep')
    let taps = 0
    sheep.addEventListener('click', ()=>{
      taps++
      if(taps === 3) { document.getElementById('sheepImg').src = '/mnt/data/Gemini_Generated_Image_f8y2wdf8y2wdf8y2.png'; checkAchievement('subir_nivel', true) }
      if(taps > 6){ document.getElementById('sheepImg').src = '/mnt/data/Gemini_Generated_Image_3jhf333jhf333jhf.png'; taps = 0 }
    })

    // protector: si el navegador bloquea las rutas a /mnt/data (depende del entorno), se intenta cargar desde las mismas rutas relativas en la carpeta del proyecto.
    function testImages(){
      const img = new Image(); img.src = document.getElementById('sheepImg').src
      img.onerror = ()=>{
        // fallback: intenta rutas relativas (usuario puede mover im√°genes junto al html)
        document.getElementById('sheepImg').src = './Gemini_Generated_Image_3jhf333jhf333jhf.png'
        document.getElementById('inputPatita').querySelector('img').src = './Gemini_Generated_Image_f8y2wdf8y2wdf8y2.png'
        document.getElementById('patita').querySelector('img').src = './Gemini_Generated_Image_5hn0365hn0365hn0.png'
      }
    }
    testImages()

  </script>
</body>
</html>
